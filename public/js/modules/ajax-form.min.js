define(["jquery","AX"],function(i,e){"use strict";var t=e.Util.log,o=e.Base.extend({defaults:{$form:null,sLoaderHTML:['<div class="loader">','<i class="circle"></i>','<i class="circle"></i>','<i class="circle"></i>','<i class="circle"></i>','<i class="circle"></i>',"</div>"].join("")},init:function(e){this._config=i.extend({},this.defaults,e);var t=this.get("$form");null!==t&&(this.set("$FormInfo",t.parent(".form-container").find(".form-info")),this.set("oFormConfig",t.data("config")),this.render(),this.bind())},submit:function(){var e=this,t=this.get("$form");i.ajax({type:t.attr("method"),url:t.attr("action"),dataType:"json",data:t.serialize(),beforeSend:function(){e.loader(!0),e.get("$form").find(".form-action").find('input[type="submit"]').prop("disabled",!0).addClass("loading"),e.beforeSend()}}).done(function(i){e.loader(!1),e.get("$form").find(".form-action").find('input[type="submit"]').prop("disabled",!1).removeClass("loading"),e.success(i),e.completeCall()}).fail(function(){e.loader(!1),e.get("$form").find(".form-action").find('input[type="submit"]').prop("disabled",!1).removeClass("loading"),e.fail(),e.completeCall()})},beforeSend:function(){},completeCall:function(){},success:function(e){this.successCall&&this.successCall();var o=this.get("oFormConfig").SuccessMessage;this.get("$FormInfo").empty().append(i("<p>"+o+"</p>")),this.get("$FormInfo").removeClass("error").addClass("success"),t(e)},successCall:function(){},fail:function(){var e=this.get("oFormConfig").FailMessage;this.get("$FormInfo").empty().append(i("<p>"+e+"</p>")),this.get("$FormInfo").removeClass("success").addClass("error")},bind:function(){var i=this;this.get("$form").on("submit.AJAXForm",function(){return i.submit(),!1})},render:function(){var e=this;this.get("$form").find(".form-action .btn-wrapper").append(i(e.get("sLoaderHTML")).hide())},loader:function(i){i?this.get("$form").find(".form-action .btn-wrapper").find(".loader").show():this.get("$form").find(".form-action .btn-wrapper").find(".loader").hide()}});return o});